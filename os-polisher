#!/usr/bin/sh

readonly HOSTNAME_FILE="/etc/hostname"
readonly PACKAGES_FILE="packages"
readonly CODECS_FILE="codecs"
readonly DNF_CONFIG="/etc/dnf/dnf.conf"

hostname="fedora"
packages_list=""

#TODO
# check if deltarpm and fastestmirror are already in dnf config file

echoerr() {
	echo "$@" 1>&2
}

change_hostname() {
	if [[ -z $1 ]];then
		echoerr "Hostname is null\n"
	fi

	echo $1 >> $HOSTNAME_FILE
}

configure_dnf() {
	echo "fastestmirror=1" >> $DNF_CONFIG
	echo "deltarpm=1" >> $DNF_CONFIG
}

enable_rpmfusion() {
	dnf install https://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm
				https://download1.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-$(rpm -E %fedora).noarch.rpm
	
	dnf update
}

install_packages() {
	while IFS= read -r line; do
		packages_list+=$line"  "
	done < "$1"

	dnf install $packages_list
}

#change_hostname
#configure_dnf
#enable_rmpfusion
install_packages $PACKAGES_FILE
install_packages $CODECS_FILE

exit 0
